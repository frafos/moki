# moki
## npm modules
Two npm modules are provided currently for the client component:
1. `@moki-client/gui` - provides the GUI features related to decryption;
2. `@moki-client/es-response-parser` - provides the parsers which process the responses for ES RESTful API queries;


The modules are configured as GIT URL (`git+ssh`) depencies in the [package.json](https://github.com/intuitivelabs/moki/blob/master/Moki/client/package.json) file. They are downloaded from their repositories by calling `npm install` in the `client` directory. For more details on npm dependencies using GIT URL see
[online npm documentation](https://docs.npmjs.com/cli/v7/configuring-npm/package-json#git-urls-as-dependencies) or `man package.json`.

Public vs. [intuitivelabs](https://www.intuitivelabs.com) private versions are installed by specifying their respective GIT URL in the [package.json](https://github.com/intuitivelabs/moki/blob/master/Moki/client/package.json) file. Currently these are the GIT repositories of these modules:
1. public version:
  * [es-response-parser](https://github.com/intuitivelabs/es-response-parser);
  * [moki-gui](https://github.com/intuitivelabs/moki-gui);
2. [intuitivelabs](https://www.intuitivelabs.com) private version:
  * [es-response-parser-private](https://github.com/intuitivelabs/es-response-parser-private);
  * [moki-gui-intuitive](https://github.com/intuitivelabs/moki-gui-intuitive). this module implements only decryption specific functionality and re-exports most of the functions/objects in the public version module [es-response-parser](https://github.com/intuitivelabs/es-response-parser), which is using as a dependency;

For example, here is how the [intuitivelabs](https://www.intuitivelabs.com) private version of the npm modules could be configured in `package.json`:
```
  "dependencies": {
    "@moki-client/es-response-parser": "git+ssh://git@github.com/intuitivelabs/es-response-parser-private.git#25ffb8d",
    "@moki-client/gui": "git+ssh://git@github.com/intuitivelabs/moki-gui-intuitive.git#83dacd2",
    ...
  },
```
Access to github.com [intuitivelabs](https://github.com/intuitivelabs) repositories is needed for installing `@moki-client` modules.
1. For `git+ssh` URI use private/public key based authentication. See [ssh keys](https://github.com/settings/keys) and [ssh authentication](https://docs.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh) for more details.
2. For `git+https` URI use token based authentication. See [authentication tokens](https://github.com/settings/tokens) and [https authentication](https://docs.github.com/en/rest/overview/other-authentication-methods#basic-authentication) and for more details. Assuming the token generated by `github.com` is `BAADBEEF` here is how the `git+https` URI would look like:
```
"git+https://BAADBEEF@github.com/intuitivelabs/anonym-js.git"
```

### install the dependencies
run `npm install` in the `client` directory.

### build everything
run `npm run-scripts build` in the `client` directory.

`@moki-client/gui` requires `jsx` file translation (i.e. translating react `jsx` files into `js` files by using `babel`). this translation is triggered automatically when `npm run-scripts build` is run. it is driven by the `scripts` session of [package.json](https://github.com/intuitivelabs/moki/blob/master/Moki/client/package.json):
```
"scripts": {
    "start": "react-scripts start",
    "build": "(cd ./node_modules/@moki-client/gui/; npm run build) && react-scripts build",
    "test": "react-scripts test",
    "eject": "react-scripts eject"
  },
 ```
